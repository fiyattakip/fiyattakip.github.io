<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#3846B5" />
  <title>fiyattakip</title>
  <link rel="manifest" href="manifest.json" />
  <link rel="icon" href="icon-192.png" />
  <link rel="apple-touch-icon" href="icon-192.png" />
  <link rel="stylesheet" href="styles.css" />
</head>

<body>
  <div class="app">
    <!-- TOP BAR -->
    <header class="topbar">
      <div class="brand">
        <img class="brand__logo" src="icon-192.png" alt="fiyattakip" />
        <div class="brand__text">fiyattakip</div>
      </div>

      <div class="topbar__actions">
        <button id="btnNotifications" class="iconbtn" title="Bildirimler">
          ğŸ””
        </button>
        <button id="btnAI" class="iconbtn" title="Yapay Zeka">
          ğŸ¤–
        </button>
        <button id="btnLogout" class="pill pill--danger" title="Ã‡Ä±kÄ±ÅŸ">
          Ã‡Ä±kÄ±ÅŸ
        </button>
      </div>
    </header>

    <main class="container">

      <!-- HERO / SEARCH -->
      <section class="card hero">
        <div class="hero__head">
          <h1 class="hero__title">Fiyat KarÅŸÄ±laÅŸtÄ±r</h1>
          <span class="badge">Site iÃ§i â€œucuzdanâ€</span>
        </div>

        <p class="hero__desc">
          ÃœrÃ¼n adÄ±nÄ± yaz, seÃ§tiÄŸin sitelerde arama aÃ§ar.
          (Uygulama iÃ§inden direkt fiyat Ã§ekmek CORS/captcha yÃ¼zÃ¼nden yok.)
        </p>

        <div class="sitechips" id="siteChips"></div>

        <div class="searchrow">
          <input id="q" class="input" type="text" placeholder="ÃœrÃ¼n adÄ±nÄ± yazÄ±n..." autocomplete="off" />
          <button id="btnSearch" class="btn btn--primary">Ara</button>
        </div>

        <div class="hint">
          <strong>Arama satÄ±rlarÄ±</strong> â€” Her satÄ±r: seÃ§ili sitede arama aÃ§ar + â€œFavoriâ€ hatÄ±rlanÄ±r.
        </div>

        <div class="row row--wrap">
          <button id="btnClear" class="btn btn--ghost">Temizle</button>
          <button id="btnOpenSelected" class="btn btn--ghost">SeÃ§ili Siteleri AÃ§</button>
        </div>

        <div id="searchStatus" class="status">
          HenÃ¼z arama yapÄ±lmadÄ±.
        </div>
      </section>

      <!-- FAVORITES -->
      <section class="card">
        <div class="sectionhead">
          <div class="sectionhead__left">
            <div class="sectiontitle">
              <span class="heart">â¤</span>
              <span>Favoriler</span>
            </div>
            <div class="sectiondesc">
              Linkler gizli. Site butonlarÄ± + Copy Link var. Uygulama aÃ§Ä±lÄ±nca %5+ dÃ¼ÅŸÃ¼ÅŸ kontrolÃ¼ (demo).
            </div>
          </div>

          <div class="sectionhead__right">
            <select id="sortSelect" class="select">
              <option value="price_asc">SÄ±rala: Son fiyat (Ucuzâ†’PahalÄ±)</option>
              <option value="price_desc">SÄ±rala: Son fiyat (PahalÄ±â†’Ucuz)</option>
              <option value="site_asc">SÄ±rala: Site (Aâ†’Z)</option>
              <option value="name_asc">SÄ±rala: ÃœrÃ¼n (Aâ†’Z)</option>
            </select>
            <button id="btnRefreshFav" class="btn btn--ghost">Yenile</button>
          </div>
        </div>

        <div id="favList" class="favlist">
          <div class="empty">Favori yok.</div>
        </div>
      </section>
    </main>

    <!-- AUTH MODAL -->
    <div id="authModal" class="modal hidden" role="dialog" aria-modal="true">
      <div class="modal__backdrop" data-close="auth"></div>
      <div class="modal__panel">
        <div class="modal__title">
          <img class="modal__logo" src="icon-192.png" alt="fiyattakip" />
          <div>
            <div class="modal__brand">fiyattakip</div>
            <div class="modal__subtitle">GiriÅŸ yap / kayÄ±t ol</div>
          </div>
        </div>

        <div class="tabs">
          <button class="tab tab--active" id="tabLogin">GiriÅŸ</button>
          <button class="tab" id="tabRegister">KayÄ±t</button>
        </div>

        <div class="form">
          <label class="label">Email</label>
          <input id="email" class="input" type="email" placeholder="mail@ornek.com" />

          <label class="label">Åifre</label>
          <div class="pwrow">
            <input id="password" class="input" type="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" />
            <button id="togglePw" class="pwbtn" type="button">ğŸ‘</button>
          </div>

          <div id="registerExtra" class="hidden">
            <label class="label">Åifre (tekrar)</label>
            <div class="pwrow">
              <input id="password2" class="input" type="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" />
              <button id="togglePw2" class="pwbtn" type="button">ğŸ‘</button>
            </div>
          </div>

          <button id="btnAuthAction" class="btn btn--primary btn--wide">GiriÅŸ Yap</button>

          <button id="btnGoogle" class="btn btn--ghost btn--wide">G Google ile devam et</button>

          <div id="authErr" class="error hidden"></div>
        </div>
      </div>
    </div>

    <!-- AI SETTINGS MODAL -->
    <div id="aiModal" class="modal hidden" role="dialog" aria-modal="true">
      <div class="modal__backdrop" data-close="ai"></div>
      <div class="modal__panel">
        <div class="modal__title">
          <div class="modal__brand">âœ¨ Yapay Zeka AyarlarÄ±</div>
          <div class="modal__subtitle">API anahtarÄ± sadece cihazÄ±nda saklanÄ±r.</div>
        </div>

        <div class="form">
          <label class="label">SaÄŸlayÄ±cÄ±</label>
          <select id="aiProvider" class="select">
            <option value="gemini">Gemini</option>
            <option value="openai">OpenAI</option>
          </select>

          <label class="label">Gemini API Key</label>
          <input id="geminiKey" class="input" type="password" placeholder="AIza..." />

          <label class="label">OpenAI API Key</label>
          <input id="openaiKey" class="input" type="password" placeholder="sk-..." />

          <div class="row row--wrap">
            <button id="btnSaveAI" class="btn btn--primary">Kaydet</button>
            <button id="btnClearAI" class="btn btn--ghost">Temizle</button>
          </div>

          <div class="hint">
            Not: GitHub Pagesâ€™te API keyâ€™i koda yazmak gÃ¼venli deÄŸildir. Bu ekran gÃ¼venli yÃ¶ntemdir.
          </div>
        </div>
      </div>
    </div>

    <!-- CHART MODAL -->
    <div id="chartModal" class="modal hidden" role="dialog" aria-modal="true">
      <div class="modal__backdrop" data-close="chart"></div>
      <div class="modal__panel modal__panel--wide">
        <div class="modal__title">
          <div class="modal__brand">ğŸ“ˆ Fiyat GrafiÄŸi</div>
          <div class="modal__subtitle">KayÄ±tlar: son 50 veri</div>
        </div>
        <div class="chartwrap">
          <canvas id="chartCanvasBig" width="900" height="420"></canvas>
        </div>
        <div class="row row--wrap">
          <button class="btn btn--ghost" data-closebtn="chart">Kapat</button>
        </div>
      </div>
    </div>

  </div>

  <!-- Firebase (CDN) -->
  <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-firestore-compat.js"></script>

  <script src="firebase.js"></script>
  <script src="app.js"></script>

  <script>
    if ("serviceWorker" in navigator) {
      window.addEventListener("load", () => navigator.serviceWorker.register("./sw.js"));
    }
  </script>
</body>
</html>
