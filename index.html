<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>FiyatTakip - AkÄ±llÄ± Fiyat KarÅŸÄ±laÅŸtÄ±rma</title>
  <meta name="description" content="Trendyol, Hepsiburada, n11, Amazon ve daha fazlasÄ±nda fiyat karÅŸÄ±laÅŸtÄ±rma">
  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="styles.css">
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <meta name="theme-color" content="#0b1020">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
</head>

<body>
  <!-- LOGIN MODAL -->
  <div id="loginModal" class="modalWrap" aria-hidden="true">
    <div class="modalBack" id="loginBackdrop"></div>
    <div class="modalCard" role="dialog" aria-modal="true" aria-label="GiriÅŸ">
      <div class="modalTop">
        <div class="modalTitle">GiriÅŸ Yap</div>
        <button id="closeLogin" class="iconBtn" type="button" aria-label="Kapat">âœ•</button>
      </div>

      <div class="authTabs">
        <button id="tabLogin" class="btnGhost sm isActive" type="button">GiriÅŸ</button>
        <button id="tabRegister" class="btnGhost sm" type="button">KayÄ±t</button>
      </div>

      <div class="authTools">
        <button id="btnClearCache" class="btnGhost sm" type="button">ğŸ§¹ Temizle</button>
      </div>

      <div id="loginPane" class="authPane">
        <label class="lbl">E-posta</label>
        <input id="loginEmail" type="email" autocomplete="email" placeholder="ornek@mail.com" />
        <label class="lbl">Åifre</label>
        <input id="loginPass" type="password" autocomplete="current-password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" />
        <div class="row">
          <button id="btnLogin" class="btnPrimary" type="button">GiriÅŸ Yap</button>
          <button id="btnGoogleLogin" class="btnGhost" type="button">Google ile</button>
        </div>
      </div>

      <div id="registerPane" class="authPane hidden">
        <label class="lbl">E-posta</label>
        <input id="regEmail" type="email" autocomplete="email" placeholder="ornek@mail.com" />
        <label class="lbl">Åifre</label>
        <input id="regPass" type="password" autocomplete="new-password" placeholder="en az 6 karakter" />
        <label class="lbl">Åifre (Tekrar)</label>
        <input id="regPass2" type="password" autocomplete="new-password" placeholder="ÅŸifreyi tekrar yaz" />
        <div class="row">
          <button id="btnRegister" class="btnPrimary" type="button">KayÄ±t Ol</button>
          <button id="btnGoogleLogin2" class="btnGhost" type="button">Google ile</button>
        </div>
        <div class="mini muted">KayÄ±t olunca otomatik giriÅŸ yapÄ±lÄ±r.</div>
      </div>
    </div>
  </div>

  <!-- APP -->
  <div id="app" class="appShell">
    <!-- TOP HEADER -->
    <header class="topbar">
      <div class="brand">
        <div class="logoDot"></div>
        <div class="brandText">FiyatTakip</div>
      </div>
      <button id="btnBell" class="iconBtn" type="button" aria-label="Bildirim">ğŸ””</button>
    </header>

    <!-- PAGES -->
    <main class="pages">
      <!-- HOME -->
      <section id="page-home" class="page active">
        <div class="searchCard">
          <div class="searchRow">
            <span class="sIcon">ğŸ”</span>
            <input id="qNormal" placeholder="ÃœrÃ¼n ve maÄŸaza araâ€¦" />
            <button id="btnMic" class="iconBtn" type="button" aria-label="Ses">ğŸ™ï¸</button>
          </div>

          <!-- Arama Modu Toggle -->
          <div class="modeToggle" id="modeToggle">
            <button class="modeBtn active" id="modeNormal" type="button">ğŸ”— Link</button>
            <button class="modeBtn" id="modeFiyat" type="button">ğŸ’° Fiyat</button>
            <button class="modeBtn" id="modeAI" type="button">ğŸ¤– AI</button>
          </div>
          <div class="modeHint" id="modeHint">Link modu: Sadece arama linkleri oluÅŸturur</div>

          <button id="btnNormal" class="btnPrimary full" type="button">Ara</button>
        </div>

        <!-- Banner - TIKLANABÄ°LÄ°R -->
        <div class="banner" onclick="openCompareModal()" style="cursor:pointer;">
          <div class="bannerLeft">ğŸŒ¸</div>
          <div class="bannerMid">
            <div class="bannerTitle">Fiyat KarÅŸÄ±laÅŸtÄ±rma!</div>
            <div class="bannerSub">Trendyol, Hepsiburada, n11, Amazon</div>
            <div class="compareCounter">
              <span id="compareCount">0</span> Ã¼rÃ¼n karÅŸÄ±laÅŸtÄ±rÄ±lÄ±yor
            </div>
          </div>
          <div class="bannerRight">ğŸ›ï¸</div>
        </div>

        <!-- HÄ±zlÄ± Aramalar -->
        <div class="quickSearches">
          <h3>HÄ±zlÄ± Aramalar</h3>
          <div class="quickTags">
            <span class="quickTag" data-query="iphone 15">ğŸ“± iPhone</span>
            <span class="quickTag" data-query="airpods">ğŸ§ AirPods</span>
            <span class="quickTag" data-query="nike ayakkabÄ±">ğŸ‘Ÿ Nike</span>
            <span class="quickTag" data-query="televizyon">ğŸ“º TV</span>
            <span class="quickTag" data-query="laptop">ğŸ’» Laptop</span>
          </div>
        </div>

        <!-- Son Aramalar -->
        <div class="recentSearchesCard">
          <h3>Son Aramalar</h3>
          <div class="recentList" id="recentList"></div>
        </div>
      </section>

      <!-- SEARCH RESULTS -->
      <section id="page-search" class="page">
        <div class="pageHead">
          <div class="pageTitle">SonuÃ§lar</div>
          <button id="btnClearSearch" class="btnGhost" type="button">Temizle</button>
        </div>
        <div id="normalList" class="list">
          <!-- Fiyat sonuÃ§larÄ± buraya eklenecek -->
        </div>
      </section>

      <!-- GRAFÄ°K SAYFASI -->
      <section id="page-graph" class="page">
        <div class="pageHead">
          <div class="pageTitle">ğŸ“Š Grafik</div>
          <button id="btnGraphRefresh" class="btnGhost" type="button">Yenile</button>
        </div>
        <div class="miniHint">Favorilerinin fiyat geÃ§miÅŸi burada gÃ¶rÃ¼necek.</div>
        <div id="graphRoot" class="cardBox">Grafik alanÄ±</div>
      </section>

      <!-- FAVORITES -->
      <section id="page-favs" class="page">
        <div class="pageHead">
          <div class="pageTitle">Favoriler</div>
          <button id="btnFavRefresh" class="btnGhost" type="button">Yenile</button>
        </div>
        <div id="favList" class="list"></div>
      </section>

      <!-- SETTINGS -->
      <section id="page-settings" class="page">
        <div class="pageHead">
          <div class="pageTitle">Ayarlar</div>
        </div>

        <div class="cardBox">
          <div class="rowBetween">
            <div>
              <div class="cardTitle">API AyarlarÄ±</div>
              <div class="miniHint">Fiyat API URL'si</div>
            </div>
            <button id="btnApiSettings" class="btnPrimary" type="button">DÃ¼zenle</button>
          </div>
        </div>

        <div class="cardBox">
          <div class="rowBetween">
            <div>
              <div class="cardTitle">ğŸ¤– AI Sistemi</div>
              <div class="miniHint">Hugging Face AI aktif - Favorilerde AI butonuna tÄ±kla!</div>
            </div>
            <button class="btnPrimary" type="button" style="background:linear-gradient(135deg, #7c5cff, #36d399);">Aktif</button>
          </div>
        </div>

        <div class="cardBox">
          <div class="rowBetween">
            <div>
              <div class="cardTitle">Hesap</div>
              <div class="miniHint">Ã‡Ä±kÄ±ÅŸ yap</div>
            </div>
            <button id="logoutBtn" class="btnGhost" type="button">Ã‡Ä±kÄ±ÅŸ</button>
          </div>
        </div>

        <div class="miniHint">Cache sorunlarÄ±nda: Site verilerini temizle / PWA'yÄ± kaldÄ±r-ekle.</div>
      </section>
    </main>

    <!-- TABBAR - 4 SEKMELÄ° -->
    <nav class="tabbar" aria-label="Alt MenÃ¼">
      <button class="tab active" type="button" data-page="home">
        <span class="ico svg home"></span>
        <span class="lbl">Ana</span>
      </button>

      <button class="tab" type="button" data-page="graph">
        <span class="ico svg graph"></span>
        <span class="lbl">Grafik</span>
      </button>

      <!-- ORTA KAMERA (YENÄ°) -->
      <button id="fabCamera" class="cameraFab" type="button" aria-label="Kamera">
        <span class="camIcon"></span>
      </button>

      <button class="tab" type="button" data-page="favs">
        <span class="ico svg fav"></span>
        <span class="lbl">Favori</span>
      </button>

      <button class="tab" type="button" data-page="settings">
        <span class="ico svg settings"></span>
        <span class="lbl">Ayarlar</span>
      </button>
    </nav>

  </div>

  <!-- TOAST MESAJ -->
  <div id="toast" class="toast hidden"></div>

  <!-- API AYARLARI MODAL -->
  <div id="apiModal" class="modalWrap" aria-hidden="true">
    <div class="modalBack" id="apiBackdrop"></div>
    <div class="modalCard" role="dialog" aria-modal="true" aria-label="API AyarlarÄ±">
      <div class="modalTop">
        <div class="modalTitle">API AyarlarÄ±</div>
        <button id="closeApi" class="iconBtn" type="button" aria-label="Kapat">âœ•</button>
      </div>

      <div class="modalBody">
        <div class="row">
          <label class="lbl">API URL</label>
          <input id="apiUrl" class="input inputDark" type="text" placeholder="https://fiyattakip-api.onrender.com/api" />
        </div>

        <div class="row">
          <label class="lbl">API Durumu</label>
          <div id="apiStatus" class="apiStatus offline">BaÄŸlantÄ± yok</div>
        </div>

        <div class="row">
          <button id="btnTestApi" class="btnGhost" type="button">Test Et</button>
          <button id="btnSaveApi" class="btnPrimary" type="button">Kaydet</button>
        </div>

        <div class="mini muted">Render.com'dan aldÄ±ÄŸÄ±n API URL'sini buraya yapÄ±ÅŸtÄ±r.</div>
      </div>
    </div>
  </div>

  <!-- KARÅILAÅTIRMA MODALI - BASÄ°T VE Ã‡ALIÅAN -->
  <div id="compareModal" class="modalWrap" aria-hidden="true">
    <div class="modalBack" id="compareBackdrop"></div>
    <div class="modalCard" role="dialog" aria-modal="true" aria-label="KarÅŸÄ±laÅŸtÄ±rma" style="max-width:500px;width:95%;">
      <div class="modalTop">
        <div class="modalTitle">
          <span>âš–ï¸ KarÅŸÄ±laÅŸtÄ±rma</span>
          <span style="font-size:14px;color:#36d399;margin-left:8px;">
            (<span id="compareCountModal">0</span>)
          </span>
        </div>
        <button class="iconBtn" id="closeCompareBtn">âœ•</button>
      </div>

      <div class="modalBody">
        <!-- Butonlar -->
        <div style="display:flex;gap:8px;margin-bottom:15px;">
          <button class="btnGhost sm" id="addManualBtn">â• Ekle</button>
          <button class="btnGhost sm" id="clearCompareBtn">ğŸ—‘ï¸ Temizle</button>
          <button class="btnPrimary sm" id="aiCompareBtn">ğŸ¤– AI</button>
        </div>
        
        <!-- Manuel Ekleme -->
        <div class="cardBox" id="manualPanel" style="display:none;margin-bottom:15px;">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;">
            <div style="font-weight:bold;">ğŸ”— Link veya ÃœrÃ¼n AdÄ±</div>
            <button class="iconBtn" id="closeManualBtn">âœ•</button>
          </div>
          <input type="text" id="manualInput" placeholder="Link veya Ã¼rÃ¼n adÄ±..." 
                 style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.2);background:rgba(255,255,255,0.05);color:white;margin-bottom:10px;">
          <div style="display:flex;gap:8px;">
            <button class="btnGhost" id="fetchLinkBtn">ğŸ”— Linkten Getir</button>
            <button class="btnPrimary" id="searchMatchBtn">ğŸ” Bul ve EÅŸleÅŸtir</button>
          </div>
        </div>

        <!-- KarÅŸÄ±laÅŸtÄ±rma Listesi -->
        <div id="compareListContainer">
          <div style="text-align:center;padding:40px 20px;color:rgba(255,255,255,0.7);">
            <div style="font-size:48px;margin-bottom:15px;opacity:0.5;">âš–ï¸</div>
            <h3 style="color:white;margin-bottom:10px;">KarÅŸÄ±laÅŸtÄ±rma Listesi BoÅŸ</h3>
            <p>ÃœrÃ¼nlerdeki "âš–ï¸ KarÅŸÄ±laÅŸtÄ±r" butonuna tÄ±klayÄ±n.</p>
          </div>
        </div>

        <!-- AI SonuÃ§ -->
        <div class="cardBox" id="aiResultPanel" style="display:none;margin-top:15px;background:rgba(124,92,255,0.1);">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;">
            <div style="font-weight:bold;color:white;">ğŸ¤– AI KarÅŸÄ±laÅŸtÄ±rma</div>
            <button class="iconBtn" id="closeAiBtn">âœ•</button>
          </div>
          <div id="aiContent"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- SCRIPTS -->
  <script type="module" src="app.js"></script>
  <script type="module" src="compare.js"></script>
</body>
</html>
